# 가상 메모리

# 14-1 연속 메모리 할당
프로세스에 연속적인 메모리 공간을 할당하는 방식
## 스와핑
  - 현재 사용되지 않는 프로세스들을 보조기억장치의 스왑 영역으로 쫓아내어 생긴 빈 공간에 실행할 프로세스를 적재하는 것
  - 프로세스들이 요구하는 메모리 공간의 크기가 실제 메모리 크기보다 큰 경우에도 동시에 실행할 수 있음
### 스왑 아웃
  - 현재 실행되지 않는 프로세스가 메모리에서 스왑 영역으로 옮겨지는 것
### 스왑 인
  - 스왑 영역에 있던 프로세스가 다시 메모리로 옮겨오는 것
    
## 메모리 할당
비어있는 메모리 공간에 프로세스를 연속적으로 할당하는 것
### 최초 적합
  - 운영체제가 메모리 내의 빈 공간을 탐색할 때, 가장 먼저 발견되는 공간에 프로세스를 적재하는 방식
### 최적 적합
  - 운영체제가 매모리 내의 빈 공간을 모두 탐색한 후, 적재 가능한 가장 작은 공간에 할당하는 방식
### 최악 적합
  - 운영체제가 매모리 내의 빈 공간을 모두 탐색한 후, 적재 가능한 가장 큰 공간에 할당하는 방식

## 외부 단편화
빈 공간보다 큰 프로세스를 적재하기 어려운 상황을 초래하여 결국 메모리 낭비로 이어지는 것

-> 메모리 압축으로 해결
### 메모리 압축
  - 프로세스들을 메모리의 시작 주소부터 차례대로 배치하는 방식
  - 단점 : 재배치하는 동안 시스템은 하던일을 중지해야하고, 많은 오버헤드 야기함 -> 페이징 기법으로 해결


# 14-2 페이징을 통한 가상 메모리 관리
## 페이징이란 - 가상 메모리 관리 기법
모리의 물리 주소 공간을 프레임이라는 일정한 단위로 나누고 프로세스의 논리 주소 공간을 페이지라는 일정 단위로 자른 뒤 페이지를 프레임에 매핑하는 방식

## 페이지 테이블
프로세스를 이루는 페이지가 어떤 프레임에 적재되어 있는지를 나타내는 테이블
### 내부 단편화
  - 하나의 페이지 크기보다 작은 메모리 공간을 요구하는 프로세스로 인해 발생
### PTBR(테이블 베이스 레지스터)
  - 각 프로세스 내의 페이지 테이블이 적재된 주소를 가리킴
### TLB
  - 페이지 테이블을 메모리에 두게 되면, 메모리 접근 시간이 두 배로 늘어나게 되므로 등장
  - CPU가 접근하려는 논리 주소가 TLB에 있을 경우 TLB 히트, 없을 경우 TLB 미스

## 페이징에서의 주소 변환
### 특정 주소에 접근하기 위해서 필요한 것
  - 어떤 페이지 혹은 프레임에 접근하고 싶은지
  - 접근하려는 주소가 그 페이지 혹은 프레임에서 얼마나 떨어져 있는지
    
## 페이지 테이블 엔트리
페이지 테이블의 각각의 행
아래 네 가지의 정보도 포함
### 유효 비트
  - 현재 해당 페이지에 접근 가능한지 여부
### 보호 비트
  - 페이지 보호를 위한 비트
### 참조 비트
  - CPU가 해당 페이지에 접근했는지 여부
### 수정 비트
  - CPU가 해당 페이지에 쓰기 접근했는지 여부

# 14-3 페이지 교체와 프레임 할당
## 요구 페이징
  - 요구되는 페이지만 적재하는 기법
  - 요구 페이징 시스템이 안정적으로 작동하려면 페이지 교체와 프레임 할당을 해결해야 함
    
-> 페이지 교체를 결정하는 방법 : 페이지 교체 알고리즘
## 페이지 교체 알고리즘
페이지 폴트를 가장 적게 일으키는 알고리즘
### FIFO 페이지 교체 알고리즘
  - 가장 오래 전에 적재된 페이지를 교체
### 2차 기회 페이지 교체 알고리즘
  - 참조 비트를 추가하여, 참조 비트가 0인 페이지를 교체(기회를 한 번 더줌)
### 최적 페이지 교체 알고리즘
  - CPU에 의해 참조되는 횟수를 고려
### LRU 페이지 교체 알고리즘
  - 가장 오랫동안 참조되지 않은 페이지를 교체
    
## 스래싱과 프레임 할당
프로세스가 사용할 수 있는 프레임 자체가 적어도 페이지 폴트 발생
### 스래싱
  - 프로세스가 실제 실행되는 시간보다 페이징에 더 많은 시간을 소요하여 성능이 저해되는 문제
  - 각 프로세스가 필요로 하는 최소한의 프레임 수를 파악하고, 프로세스들에게 적절한 프레임을 할당하는 것으로 해결
### 정적 프레임 할당 방식
  - 균등 할당 : 각 프로세스에게 동일한 프레임 수를 할당하는 방식
  - 비례 할당 : 각 프로세스에게 프레임 수를 프로세스 크기에 비례하여 할당
### 동적 프레임 할당 방식
  - 작업 집합 모델 : CPU가 특정 시간동안 주로 참조한 페이지 개수만큼만을 프레임으로 할당
  - 페이지 폴트 빈도 모델 : 페이지 폴트가 발생한 횟수를 기준으로 프레임을 할당
