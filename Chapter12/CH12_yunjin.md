# Chapter 12 프로세스 동기화

# 12 -1 동기화란

- 동기화 (Synchronization)
    - 공동의 목적을 위해 동시에 수행되는 프로세스 → `**실행 순서**`와 `**자원의 일관성**`을 보장하기 위한 필요
    - 프로세스 동기화
    `**프로세스들 사이의 수행 시기를 맞추는 것**`
    - 필요한 것들
        - ***실행 순서 제어*** : 프로세스를 올바른 순서대로 실행
            - Write 후에 Read 해야 함.
        - ***상호 배제*** : `동시에 접근해서는 안 되는` 자원에 하나의 프로세스만 접근하게 막기
            - 공유가 불가능한 자원의 동시 사용을 피하기 위해 사용하는 알고리즘
            - 대표적 문제 : Bank account problem
            
            
            - 대표적 문제 : 생산자와 소비자 문제 (Producer & Consumer Problem)
                
                 

- 공유 자원과 임계 구역
    - **공유 자원**
        - 여러 프로세스 혹은 스레드가 공유하는 자원
            - 전역 변수, 파일, 입출력장치 ,보조 기억 장치
    - **임계 구역**
        - `**동시에 실행하면 문제가 발생하는 자원에 접근하는 코드 영역**`
            - 총합 변수, 잔액 변수
        - `레이스  컨디션`
            - `임계 구역에 동시에 접근하면 자원의 일관성이 깨질 수 있다.`
- ***임계 구역 문제** 해결을 위한  세 가지 원칙 (상호 배제를 위한 동기화를 위한)*
    - **`상호 배제`** - 한 프로세스가 임계 구역에 진입했다면 다른 프로세스는  임계 구역에 들어 올 수 없다.
    - **`진행`** - 임계 구역에 어떤 프로세스가 진입하지 않았다면 임계 구역에 진입하고자 하는 프로세스는 들어갈 수 있어야 한다.
    - **`유한 대기`** - 한 프로세스가 임계 구역에 진입하고 싶다면 그 프로세스는 언젠가는 임계 구역에 들어올 수 있어야 한다. (임계 구역에 들어오기 위해 무한정 대기해서는 안된다.)

# 12 -2 동기화 기법

- `***뮤텍스 락***`
    - 비유 : 탈의실의 자물쇠
        
        
    - 구현
        - 자물쇠 역할(`lock`)
            - 프로세스들이 공유하는 전역 변수
        - 임계 구역을 잠그는 역할(`acquire`)
            - 프로세스가 임계 구역에 `진입하기 전에` 호출하는 함수
        - 임계 구역의 잠금을 해제하는 역할(`release`)
            - 자물쇠 반환
    - 바쁜 대기
        - 반복해서 대기하는 것



- `***세마포(Semaphore)***`
    - 공유 자원이 여러개 있는 경우에도 적용 가능하다.
    - 임계 구역 앞에서 멈춤 신호를 받으면 잠시 기다리기, 가도 좋다는 신호를 받으면 임계 구역 진입
    - 구현
        - 전역변수 하나, 함수 두개
        - 프로세스 개수 : `S`
        - 임계 구역에 들어가도 좋은지, 기다려야 할지를 알려주는 `wait`
        - 임계구역 앞에서 기다리는 프로세스에 ‘이제 가도 좋다’고 신호를 주는 `signal`
        

→ busy waiting 극복


- `***모니터(Monitoring)***`
    - 모니터를 통해 공유 자원에 접근하고자 하는 프로세스를 큐에 삽입하고, 큐에 삽입된 순서대로 하나씩 공유 자원을 이용하도록 합니다.
    - 조건 변수
        - 특정 조건을 바탕으로 프로세스를 실행하고 일시 중단하기 위해 모니터는 조건 변수를 사용
    - wait
    - signal