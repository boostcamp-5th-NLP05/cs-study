## CPU 스케줄링 개요

운영체제가 프로세스들에게 공정하고 합리적으로 CPU 자원을 배분하는 것이 CPU 스케줄링

### 프로세스 우선순위

프로세스마다 운선순위가 다르기 때문에 먼저 요청한 프로세스 순서대로 CPU를 이용하는 방법은 좋지 않다.

대부분의 프로세스들은 CPU와 입출력장치를 모두 사용하며 실행된다.


프로세스 종류마다 입출력 장치를 이요하는 시간과 CPU를 이용하는 시간의 양에는 차이가 있다.

입출력 작업이 많은 프로세스를 입출력 집중 프로세스
CPU 작업이 많은 프로세스를 CPU 집중 프로세스라 한다.

위 종류의 프로세스가 동일한 빈도로 CPU를 사용하는 것은 비합리적이다.

즉 각각의 상황에 맞게 CPU를 배분하는 것이 더 효율 적이다.

상황에 맞게, 프로세스의 중요도에 맞게 CPU를 이용할 수 있도록 하기 위해 운영체제는 프로세스마다 우선순위를 부여한다. 

### 스케줄링 큐

pCB에 우선순위가 있고, CPU를 사용할 다음 프로세스를 찾기 위해 운영체제가 일일이 모든 프로세스를 찾는 것은 비효율적이다. CPU를 원하는 프로세스들은 한 두개가 아니고, CPU를 요구하는 새로운 프로세스는 언제든 생길 수 있다.

CPU를 사용하고 싶은 프로세스들, 메모리에 적재되고 싶은 프로세스들, 특정 입출력장치를 사용하고 싶은 프로세스들 모두 줄 세워서 관리하는 것을 스케줄링 큐로 구현한다.


운영체제가 관리하는 큐에는 대표적으로 준비 큐(CPU를 이용하고 싶은 프로세스들이 서는 줄)와 대기 큐(임출력장치를 이용하기 위해 대기 상태에 접어든 프로세스들이 서는 줄)이 있다.


### 선점형과 비선점형 스케줄링

CPU를 사용하고 있는 프로세스가 있는데, 다른 급한 프로세스가 CPU를 지금 당장 사용하기를 요청할 때, 두 가지 방법으로 1. 지금 CPU를 사용 중인 프로세스로부터 CPU 자원을 빼앗아 다른 프로세스에 할당할 수 있고, 2. CPU를 사용 중인 프로세스 작업이 끝날 때까지 기다리게 하는 방법이 있다.
전자는 선점형 스케줄링, 후자는 비선점형 스케줄링이라 한다.

선점형 스케줄링은 프로세스가 하나의 프로세스가 자원을 독점할 수 없는 스케줄링 방식이다. 더 급한 프로세스가 언제든 끼어들어 사용할 수 있는 방식이기에 자우너 독점을 막고 프로세스들에 골고루 자원을 배분할 수 있다는 장점이 있지만, 문맥 교환 과정에서 오버헤드가 발생할 수 있다.

반대로 비선점형 스케줄링은 하나의 프로세스가 자원 사용을 독점할 수 있는 방식이다. 문맥 교환에서 발생하는 오버헤드는 적지만, 모든 프로세스가 골고루 자원을 사용할 수 없다는 단점이 있다.

## CPU 스케줄링 알고리즘

CPU 스케줄링 알고리즘의 종류는 다양하고 운영체제 마다 다른 알고리즘을 사용하고 있다. 

### 스케줄링 알고리즘의 종류

1. 선입 선처리 스케줄링
    
    단순히 준비 큐에 삽입된 순서대로 프로세스들을 처리하는 비선점형 스케줄링 방식이다. CPU를 먼저 요청한 프로세스부터 CPU를 항당하는 스케줄링 방식이고, 프로세스들이 기다리는 시간이 매우 길어질 수 있다는 점에서 부작용이 있는 방식이다.(호위 효과)
    
    
2. 최단 작업 우선 스케줄링
    
    위의 단점을 해결하는 CPU 사용 시간이 짧은 간단한 프로세스 먼저 실행하는 방법
    
    
3. 라운드 로빈 스케줄링
    
    선입 선처리 스케줄링에 타임 슬라이스라는 개념이 더해진 스케줄링 방식.
    
    타임 슬라이스란 각 프로세스가 CPU를 사용할 수 있는 정해진 시간을 의미한다. 즉, 정해진 타임 슬라이스만큼의 시간 동안 돌아가며 CPU를 이용하는 선점형 스케줄링이다.
    
    시간 내에 프로세스가 완료되지 않았다면 다시 큐의 맨 뒤에 삽입된다.
    
    타임 슬라이스 크기가 지나치게 크면 호위 효과가 해결되지 않고, 매우 작으면 문맥 교환에 발생하는 비용이 커진다.
    
4. 최소 잔여 시간 우선 스케줄링
    
    최단 작업 우선 스케줄링 알고리즘과 라운드 로빈 알고리즘을 합친 스케줄링 방식이다. 프로세스들은 정해진 타임 슬라이스만큼 CPU를 사용하되, CPU를 사용할 다음 프로세스로는 남아있는 작업 시간이 가장 적은 프로세스가 선택된다.
    
5. 우선순위 프로세스
    
    프로세스들에 우선순위를 부여하고, 가장 높은 우선순위를 가진 프로세스부터 실행하는 스케줄링 알고리즘이다.
    
    우선순위가 낮은 프로세스는 준비 큐에 먼저 삽입되었음에도 불구하고 우선순위가 높은 프로세스들에 의해 실행이 연기되는 기아 현상이 일어난다.
    
    이를 방지하기 위해 대표적인 기법으로 에이징이 있다. 오랫동안 대기한 프로세스의 우선순위를 점차 높이는 방식이다.
    
6. 다단계 큐 스케줄링
    
    우선순위 스케줄링의 발전된 형태로, 준비 큐를 여러 개 사용하는 스케줄링 방식이다.
    
    우선순위가 가장 높은 큐에 있는 프로세스들을 먼저 처리하고, 우선순위가 가장 높은 큐가 비어있으면 그다음 우선순위 큐에 있는 프로세스들을 처리한다.
    
    
    이렇게 큐를 여러 개 두면 프로세스 유형별로 우선순위를 구분하여 실행하는 것이 편리해진다.
    
    또한 큡려로 타임 슬라이스를 여러 개 지정할 수 있고, 큐마다 다른 스케줄링 알고리즘을 사용할 수 있따.
    
7. 다단계 피드백 큐 스케줄링
    
    다단계 큐 스케줄링의 발전된 형태이다. 다단계 큐 스케줄링은 기아 현상이 발생할 수 있기때문에 이를 보완한 알고리즘이다.
    
    프로세스들이 큐 사이를 이동할 수 있다는 점이 다단계 큐 스케줄링과 다르다.
    
    다단계 피드백 큐 스케줄링에서 새로 준비 상태가 된 프로세스가 있다면 우선 우선순위가 가장 높은 우선순위 큐에 삽입되고 일정 시간 동안 실행된다.
    
    해당 큐에서 실행이 끝나지 않는다면 다음 우선순위 큐에 삽입되어 실행된다. 결국 CPU를 오래 사용해야 하는 프로세스는 점차 우선 순위가 낮아진다.
    
    또한 낮은 우선순위 큐에서 너무 오래 기다리로 있는 프로세스가 있다면 점차 우선순위가 높은 큐로 이동시키는 에이징 기법을 적용하여 기아 현상을 예방한다.
    
